# 豆瓣电影网络爬虫

任务内容概览：

- 爬取到所有（有链接）的电影
- 爬取时以**广度优先**的方式
- 存储爬取到的数据
  
  - 每个电影为一个对象进行存储
  - 每个导演为一个对象进行存储
  - 每个主演为一个对象进行存储
  - 每个国家为一个对象
  - 每个类型为一个对象

- 存储对象间的关系
- 存储电影和电影之间观众都喜欢的关系

## 实现架构

将该爬虫分割为：

- 网页下载器：根据传入的URL下载HTML内容
- URL管理器：采用队列的思想进行URL的进出管理
- 数据库管理器：控制neo4j数据库的读写
- 本地CSV读写器
- 网页分析器：
  - top250页面分析器
  - 电影内容页面
  - 导演内容页面
- 主程序逻辑

1. 首先，主程序遍历top250页面，并且由分析器提取出250个电影链接，
2. 将键值对[名字+链接]存入URL管理器
3. 接着，进入电影内容页面（主）爬虫功能
4. 提取当前电影页面的所有信息
5. 调用数据库管理器，创建相应的电影对象
6. 调用数据库管理器，建立对应的对象间关系
7. 将当前页面有的电影内容链接，存入URL管理器
8. 若URL管理器不空，回到第4步
9. 调用数据库管理器，提取所有导演的数据
10. 以键值对的形式[导演名字+链接]存入URL管理器
11. 提取URL管理器中一个数据
12. 分析该导演的所有作品
13. 调用数据库管理器
14. 若URL管理器不空，回到第11步，否则结束

## 数据库存储结构

> neo4j图数据库

1. 电影内容对象(movie)

    属性名称（键） | 参数类型(值) | 说明
    --- | --- | ---:
    name | str字符串 | 电影名字
    originalName | str | 电影原名
    otherName | str | 其他名字
    link | str | 详细内容链接
    country | str | 国家
    year | int正整数 | 上映年份
    date | int | 上映时间，如0120
    length | int | 电影时长
    score | float | 电影评分

2. 导演对象(director)
    属性名称（键） | 参数类型(值) | 说明
    --- | --- | ---:
    name | str | 导演名字
    originalName | str | 原名
    link | str | 导演页面链接
3. 演员对象(actor)
    属性名称（键） | 参数类型(值) | 说明
    --- | --- | ---:
    name | str | 演员名字
    originalName | str | 原名
    link | str | 演员页面链接
4. 电影类型对象(movieType)
    属性名称（键） | 参数类型(值) | 说明
    --- | --- | ---:
    name | str | 电影类型
5. 对象间关系
    源对象 | 关系 | 目标对象 | 说明
    --- | --- | --- | ---
    director | 导演 | movie
    movie | 电影类型属于 | movieType
    actor | 参演 | movie
    actor | 合作过 | director | 双向关系
    movie | 喜欢本电影也喜欢 | movie | 双向关系
